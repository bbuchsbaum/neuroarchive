% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hrbf_helpers.R
\name{generate_hrbf_atom}
\alias{generate_hrbf_atom}
\title{Generate an analytic HRBF atom over a mask}
\usage{
generate_hrbf_atom(
  mask_coords_world,
  mask_linear_indices,
  centre_coord_world,
  sigma_mm,
  current_level_j,
  total_levels,
  params,
  normalize_over_mask = TRUE
)
}
\arguments{
\item{mask_coords_world}{Numeric matrix of world coordinates for the mask
voxels (\eqn{N_{maskvox} \times 3}).}

\item{mask_linear_indices}{Integer vector of the same length giving the voxel
linear indices within the full volume.}

\item{centre_coord_world}{Numeric vector of length 3 giving the RBF centre in
world coordinates.}

\item{sigma_mm}{Numeric width parameter in millimetres.}

\item{current_level_j}{Integer level index of this atom (0-indexed).}

\item{total_levels}{Total number of levels in the pyramid (\eqn{J}).}

\item{params}{Parameter list defining \code{kernel_type},
\code{kernel_type_fine_levels} and \code{num_fine_levels_alt_kernel}.}

\item{normalize_over_mask}{Logical; if \code{TRUE} the returned values are
normalised to unit \eqn{L_2} norm over the mask.}
}
\value{
A list with elements \code{values} (numeric vector of length
  \code{nrow(mask_coords_world)}) and \code{indices}
  (\code{mask_linear_indices}).
}
\description{
Internal helper that evaluates a radial basis function centred at
`centre_coord_world` on all voxels of a mask. The mask is provided via its
voxel world coordinates and corresponding linear indices. Optionally the atom
is \eqn{L_2}-normalised over the mask voxels.
}
\keyword{internal}
